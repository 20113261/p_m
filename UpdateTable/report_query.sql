# 经纬度为 0 影响范围
SELECT
  city.id,
  country.name,
  city.name,
  t.num
FROM (SELECT
        city_id,
        count(*) AS num
      FROM new_detail_qyer_1212
      WHERE source = 'qyer' AND id IN
                                ('1317603', '207511', '1226767', '1312867', '1143489', '1139756', '1143525', '1280214', '1372074', '1404485', '1139567', '1257059', '1146853', '1219524', '1142720', '1146302', '1176687', '1143426', '1146474', '1146603', '1139515', '1250998', '1144779', '1142579', '1149753', '1143404', '580994', '582173', '1370914', '1160910', '1143375', '1278270', '1279660', '1141590', '1391454', '1144027', '1142441', '1446371', '1161110', '1142224', '1141819', '582174', '1142858', '1146103', '1149761', '1143547', '1143702', '1164011', '1271652', '1149160', '1404234', '1148866', '582008', '1226779', '1207177', '1280338', '1207225', '1144492', '1370244', '1145212', '1318434', '1446318', '1397810', '104428', '1145163', '196487', '1142919', '580359', '1202646', '580251', '1149190', '1146745', '1279802', '1145171', '1141114', '1144535', '1146163', '1146165', '1161115', '1278844', '1144581', '1149201', '206340', '1200664', '1144619', '1145993', '1203815', '1330511', '1142585', '1203779', '1279498', '1203670', '1143156', '1455081', '1146318', '1148838', '204609', '1144433', '1148538', '582179', '1280805', '1142870', '1140817', '1450465', '1145831', '1143133', '1227028', '1143950', '1149358', '1145274', '1371980', '1205121', '1140989', '1145527', '1142693', '1146053', '1161112', '202159', '1160822', '1147095', '1161232', '1431656', '1143878', '1146032', '1161116', '1280014', '1143078', '1145720', '1142969', '1143295', '1143292', '1142712', '1176643', '1358524', '1205801', '1163184', '1146596', '581421', '1212866', '1145404', '1448134', '1398460', '1160886', '1145230', '1450464', '1277561', '1142283', '1209161', '1143334', '1216091', '1226900', '1279651', '582183', '1161253', '1145560', '1294031', '1144751', '1142199', '1431681', '579024', '1391820', '1145612', '164301', '1148969', '1226764', '1280799', '1318596', '1407627', '1144495', '1216024', '1147132', '1203786', '1141975', '1145763', '1142690', '1160762', '1146109', '1453617', '1404350', '1297371', '1210514', '1146618', '1250853', '1141335', '1146172', '1208498', '1277566', '1140730', '1209945', '1161029', '1404230', '1152150', '1146352', '1207924', '1164010', '1216049', '1233643', '1141485', '1262314', '1319275', '1330892', '1142203', '1141534', '1370905', '1404970', '580250', '1262315', '1142652', '1143257', '1141579', '201866', '1337604', '582175', '1317635', '1146470', '1142582', '1143192', '1141756', '177289', '1398356', '1142733', '1426470', '1149565', '1273302', '1409279', '1397622', '1203845', '1227029', '1431953', '1145884', '1353133', '1146375', '121787', '1405101', '1426221', '1152011', '204636', '1163417', '1142888', '1144728', '1186729', '1145174', '1426361', '1198528', '1144933', '1148031', '1247233', '1370929', '1143416', '1144380', '1143360', '1143819', '1206098', '1370920', '1431664', '1209910', '1143020', '1162993', '1146444', '1146247', '1406948', '1142223', '1206764', '1209947', '1186693', '1142686', '1143801', '1404974', '1140619', '1279976', '1212903', '1147089', '1142673', '1143538', '1446372', '1176457', '1149615', '1143673', '200504', '1408129', '1446266', '1140672', '1146540', '1146730', '582169', '1146050', '1407603', '1297370', '1142610', '1140626', '407840', '1186685', '1446388', '1251137', '1279662', '1149599', '1262049', '1151685', '1163463', '1201632', '1279661', '1391564', '1145694', '1142745', '1142230', '1141116', '1330345', '1161023', '200940', '202977', '1144608', '1161320', '1212970', '1144565', '1319306', '1145719', '1146044', '1403221', '1144153', '1206504', '1162979', '581292', '1317692', '1142225', '1146239', '82927', '1143764', '1140772', '1446420', '1143294', '1144542', '1327081', '1141150', '1146029', '1161209', '1139907', '1144289', '204421', '1398449', '1143245', '1145624', '1142390', '1407751', '1142578', '1146436', '1317833', '1149112', '1434779', '1404737', '1208814', '582178', '582358', '1150659', '207510', '1142600', '1297513', '1143255', '1143761', '1145428', '1148816', '1141783', '1250738', '1143254', '1279678', '1404494', '1446421', '1273129', '1444154', '1338216', '1226828', '1150663', '1210522', '1215919', '1148520', '1251132', '1412165', '1146581', '1279891', '1167967', '1142699', '1144539', '1209256', '1148541', '581354', '1146171', '124347', '407839', '1143930', '1279342', '1140317', '1399836', '1272076', '1446387', '1147099', '582170', '1145971', '1144188', '1161106', '1407441', '1144798', '1149755', '1141133', '1145336', '1337591', '1142594', '1216042', '1146915', '1145011', '200939', '1144759', '1250850', '1206093', '1139493', '1257352', '1217583', '1358225', '1150993', '1140387', '1144815', '1317829', '1145818', '1227003', '1360735', '1226776', '1151910', '1186920', '1312917', '1370789', '1143443', '1216453', '1140627', '1145407', '1371009', '1146767', '1262330', '1209890', '1407439', '1293848', '1150657', '1145054', '1149577', '1370610', '1143622', '1143442', '1145785', '1226874', '1142856', '1145728', '1226813', '1250821', '1139754', '1278230', '1399743', '1424800', '1140205', '1147037', '1161213', '1146169', '280041', '1141333', '1450461', '1294112', '1404635', '1145107', '1144118', '1147101', '1317665', '1186684', '1145715', '1143945', '1219076', '1161078', '1280292', '1160793', '1370906', '1455857', '1146253', '1149324', '1162997', '1273047', '1145075', '1139301', '582186', '1226984', '1141327', '1163934', '1142814', '1330190', '1209255', '1142325', '1145653', '200923', '1142836', '1149512', '206424', '1146052', '1216139', '1274517', '1215982', '1143703', '1145945', '1160631', '1206490', '1370614', '1437736', '1151893', '1226829', '1147759', '1227004', '579725', '1431666', '1145094', '1280239', '1142232', '1144010', '1161081', '1148810', '1147717', '1144473', '1140435', '1317632', '1139813', '1318052', '1144917', '1146888', '1144230', '1371981', '1201687', '1274576', '1161142', '1143300', '1145102', '1210524', '1146059', '1326860', '1144537', '1149601', '1206253', '1161141', '1447678', '1210513', '1140755', '1144672', '1142692', '1144300', '1143207', '1141131', '1431697', '1203310', '1146167', '1149247', '1212943', '1144884', '1139737', '1205212', '1297363', '1318051', '1348868', '1150665', '1451513', '1322127', '1397897', '1146214', '1262190', '199958', '1152079', '1143337', '1216073', '1142936', '1160879', '1142447', '1142637', '1144503', '1149614', '1203777')
      GROUP BY city_id) t
  JOIN base_data.city ON t.city_id = base_data.city.id
  JOIN base_data.country ON base_data.city.country_id = base_data.country.mid;

# 非景点影响范围
SELECT
  city.id,
  country.name,
  city.name,
  t.num
FROM (SELECT
        city_id,
        count(*) AS num
      FROM new_detail_qyer_1212
      WHERE source = 'qyer' AND cateid != '景点'
      GROUP BY city_id) t
  JOIN base_data.city ON t.city_id = base_data.city.id
  JOIN base_data.country ON base_data.city.country_id = base_data.country.mid;

SELECT
  city.id,
  country.name,
  city.name,
  t.num
FROM (SELECT
        city_id,
        count(*) AS num
      FROM new_detail_qyer_1212
      WHERE source = 'qyer' AND id IN
                                ('1293477', '1249501', '84476', '1329502', '1290149', '1290152', '1412195', '1248925', '1407522', '1403683', '1420068', '1330268', '1249117', '1420089', '1353829', '1290626', '1293202', '1248892', '1292486', '1249251', '82190', '1205224', '1298689', '1410184', '1249388', '1294994', '1248964', '1294985', '1293061', '1295418', '1329669', '1293087', '1249367', '1248903', '1406666', '1290558', '1297587', '1248939', '1406961', '1353702', '1292524', '1198559', '1291619', '1353694', '1293364', '1290559', '105825', '1290146', '1353690', '1403799', '1353688', '461168', '1295303', '1420311', '470153', '1295330', '1293082', '1293214', '1205842', '1407128', '1290557', '1403804', '1292501', '1426612', '1295302', '1249390', '491973', '1293208', '1295352', '1407130', '263348', '1353685', '1449173', '1198558', '1291382', '518334', '1292498', '1249476', '1293201', '1248916', '1249403', '1407150', '1290124', '1249088', '1249472', '1330296', '1353771', '1353696', '1407716', '453417', '1329809', '1329850', '1292521', '1330291', '1410146', '1420310', '1290549', '1256978', '1412189', '1406648', '1420150', '1330254', '1293089', '1329695', '1295341', '1297520', '82960', '1329690', '58327', '108200', '1291447', '1420065', '1248937', '1290545', '1292495', '1329826', '1406662', '1353820', '1297510', '1420864', '1407719', '1293376', '95049', '528884', '1248911', '1293471', '1420400', '1248952', '1406967', '1295417', '1329653', '1297507', '1293481', '1412172', '1294952', '528470', '1329689', '1198562', '1292482', '1410130', '1451632', '1248910', '1290138', '1249260', '1293062', '1329680', '444278', '1354419', '1354305', '1399619', '63797', '1329854', '1407755', '1407528', '1292608', '1406946', '125664', '1330258', '1249490', '1403675', '1353832', '1248954', '1249097', '1290121', '1353794', '1407136', '1293358', '1290134', '1292610', '1329692', '1198560', '1249364', '1293465', '1420145', '1291625', '1407124', '1330275', '1249376', '1406949', '1249090', '1329687', '1403666', '1407754', '1410182', '1294992', '558544', '1410248', '1406652', '1249101', '1292511', '1412169', '1249273', '1249369', '1248922', '1297517', '1407710', '1370890', '1291456', '1294973', '1295340', '1290069', '1329822', '1406977', '1297515', '1249103', '1293362', '1370912', '1293220', '1353812', '1407554', '1426602', '1289623', '1249295', '1292502', '529825', '1305662', '1248909', '409847', '1329658', '1406654', '1293228', '1319354', '125892', '1248943', '1420152', '1198563', '1290130', '1426596', '1426610', '1249298', '1248899', '1291616', '164053', '1248931', '1249471', '1406969', '1293230', '1292505', '1420142', '1407557', '1293217', '1410162', '1353718', '1354343', '1293084', '1248948', '1295411', '1293479', '1354422', '1407555', '1353818', '1249488', '1248896', '1249095', '1292604', '1294959', '1291618', '1329676', '1407145', '1290554', '1329845', '1410186', '1248950', '1291380', '1420285', '1292593', '1329682', '1353814', '1420154', '67189', '85355', '1406933', '1249287', '1410180', '1330299', '109363', '1353687', '1403805', '1403668', '1406660', '1249093', '1248908', '1407715', '1412179', '1407121', '1353697', '1293360', '1329665', '1407523', '1406646', '1293072', '1249375', '1407750', '87373', '1297522', '1249115', '1407752', '1291461', '1407550', '1293197', '1295344', '478822', '1297518', '1412181', '1293206', '1403670', '1292433', '1292517', '1407718', '1420402', '1292478', '1329645', '1330270', '164064', '1295346', '1249483', '1292490', '1406960', '1426647', '1330256', '1290568', '1249308', '568300', '1403798', '1198556', '1406964', '1293474', '1293462', '1293075', '1291453', '82863', '1294961', '1294956', '1406649', '1290622', '1407107', '1329813', '545440', '1249296', '1407539', '1150668', '1412192', '1290144', '1294962', '1295329', '1449592', '1420309', '1406663', '1406653', '466533', '1420401', '1420140', '1249465', '1410183', '1403809', '1291620', '1426615', '1426492', '1353703', '1198561', '1420862', '1249105', '1410179', '1290616', '538473', '1249399', '1248951', '1249247', '1420474', '1426646', '1420149', '1329846', '1353665', '1293379', '568577', '1248935', '452794', '1297516', '1249255', '1292616', '1407131', '1290552', '125673', '1354338', '1293179', '1407756', '1297509', '1329836', '1249107', '1290562', '1353682', '1403672', '1294988', '1292493', '1248969', '1297641', '1294957', '1290611', '1407714', '1407717', '1406655', '1294963', '1406644', '1249394', '1248901', '1293063', '1249293', '1410134', '1297640', '1403680', '1293081', '1354342', '1412240', '1407526', '1426613', '1249400', '1410201', '1291451', '1329811', '85997', '1292600', '1410203', '1406661', '1452214', '1293466', '1293194', '1198555', '1412176', '1407149', '1406978', '1406659', '204325', '1141711', '1248955', '1248963', '1406647', '1292591', '1329697', '1406971', '1249258', '1409143', '1249510', '105809', '1353686', '1412196', '1407533', '1329814', '1420284', '1249106', '1354420', '1407119', '1412171', '1292589', '1292594', '1420283', '1248941', '1291468', '1426624', '1352895', '1407553', '1294996', '1353778', '1293213', '1249292', '1290546', '1407529', '1266788', '1412178', '1249494', '1353827', '261739', '1292507', '1291613', '1420151', '1248949', '1295420', '1412193', '1292509', '1249253', '1291536', '1248920', '1353676', '1426603', '1403811', '1407531', '1353796', '1410185', '1426614', '1292523', '1407148', '1407127', '1330294', '1293076', '1353819', '1249508', '1407138', '1249270', '1294975', '1298700', '1293058', '1330263', '1290125', '1406955', '1290128', '1293478', '1406950', '206799', '1420143', '1329810', '1354421', '1420861', '1292614', '1407712', '1292526', '1407552', '1353830', '1406958', '1293198', '1412194', '1426605', '1420153', '1249496', '1292596', '1249383', '1420147', '1406959', '1290123', '1290623', '1249378', '1403678', '263030', '1329816', '1290154', '1198557', '568359', '1329684', '1294966', '1412180', '1329817', '1290120', '1293079', '1407753', '1420144', '1293189', '1249102', '1293231', '1248918', '1410163', '1420863', '1353776', '1295350', '1249397', '1295349', '1293055', '1249506', '1372061', '1426608', '1407125', '1403674', '1249100', '1330287', '1407707', '1249503', '1426597', '1330280', '1330283', '1407534', '1330292', '1249108', '1353692', '516325', '1249393', '1249498', '1426609', '1329853', '1420865')
      GROUP BY city_id) t
  JOIN base_data.city ON t.city_id = base_data.city.id
  JOIN base_data.country ON base_data.city.country_id = base_data.country.mid;