#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time    : 2017/12/6 下午9:34
# @Author  : Hou Rong
# @Site    : 
# @File    : select_and_update_table.py
# @Software: PyCharm
import re
import json
from data_source import MysqlSource
from service_platform_conn_pool import poi_ori_pool, poi_face_detect_pool, service_platform_pool, base_data_final_pool, \
    fetchall
from logger import get_logger

logger = get_logger("select_and_update_table")

poi_ori_config = {
    'host': '10.10.228.253',
    'user': 'mioji_admin',
    'password': 'mioji1109',
    'charset': 'utf8',
    'db': 'poi_merge'
}


def update_sql(data):
    sql = '''UPDATE chat_attraction
SET beentocount = %s, plantocount = %s
WHERE id = %s;'''
    conn = poi_ori_pool.connection()
    cursor = conn.cursor()
    try:
        _res = cursor.execute(sql, data)
    except Exception:
        print(sql)
        raise Exception()
    conn.commit()
    cursor.close()
    conn.close()
    logger.info("[total: {}][execute: {}]".format(1, _res))


def generate_qyer_url_id():
    sql = '''SELECT
  url,
  commentcounts,
  beentocounts,
  plantocounts
FROM detail_total_qyer_20171209a;'''
    _dict = {}
    for url, bc, cc, pc in fetchall(service_platform_pool, sql):
        sid = re.findall('place.qyer.com/poi/([\s\S]+)/', url)[-1]
        _dict[sid] = (bc, cc, pc)
    return _dict


def get_task():
    g_dict = generate_qyer_url_id()
    sql = '''SELECT
  id,
  commentcount,
  beentocount,
  plantocount,
  json_extract(url, '$.qyer')
FROM chat_attraction
WHERE id IN
      ('v200256', 'v200509', 'v200810', 'v200915', 'v200938', 'v201164', 'v201305', 'v201341', 'v201806', 'v201956', 'v202008', 'v202089', 'v202351', 'v202787', 'v202794', 'v202830', 'v203010', 'v203012', 'v203291', 'v203899', 'v206771', 'v207061', 'v207073', 'v217801', 'v217820', 'v217884', 'v218003', 'v218340', 'v218889', 'v218943', 'v218981', 'v223114', 'v223233', 'v223533', 'v223595', 'v223868', 'v223888', 'v223914', 'v223951', 'v223996', 'v223998', 'v224004', 'v224023', 'v224027', 'v224066', 'v224085', 'v224101', 'v224112', 'v224129', 'v224137', 'v224164', 'v224212', 'v224253', 'v224306', 'v224361', 'v224393', 'v224411', 'v224428', 'v224504', 'v224520', 'v224569', 'v224623', 'v224637', 'v224650', 'v224717', 'v224795', 'v224802', 'v224819', 'v224921', 'v224926', 'v224944', 'v224994', 'v225009', 'v225024', 'v225034', 'v225040', 'v225089', 'v225106', 'v225116', 'v225120', 'v225126', 'v225186', 'v225239', 'v225251', 'v225262', 'v225322', 'v225338', 'v225361', 'v225408', 'v225430', 'v225434', 'v225444', 'v225466', 'v225489', 'v225526', 'v225557', 'v225626', 'v225651', 'v225678', 'v225683', 'v225689', 'v225812', 'v225943', 'v225991', 'v226055', 'v226057', 'v226060', 'v226068', 'v226080', 'v226132', 'v226143', 'v226155', 'v226167', 'v226175', 'v226210', 'v226252', 'v226253', 'v226328', 'v226412', 'v226419', 'v226446', 'v226514', 'v226549', 'v226608', 'v226701', 'v226709', 'v226712', 'v226713', 'v226749', 'v226765', 'v226825', 'v226830', 'v226832', 'v226862', 'v226900', 'v226964', 'v226973', 'v226999', 'v227001', 'v227014', 'v227108', 'v227112', 'v227114', 'v227117', 'v227140', 'v227184', 'v227189', 'v227196', 'v227250', 'v227255', 'v227263', 'v227284', 'v227310', 'v227385', 'v227422', 'v227434', 'v227448', 'v227572', 'v227600', 'v227604', 'v227612', 'v227621', 'v227654', 'v227700', 'v227713', 'v227720', 'v227759', 'v227781', 'v227793', 'v227803', 'v227808', 'v227817', 'v227918', 'v227920', 'v227944', 'v227968', 'v228000', 'v228039', 'v228057', 'v228122', 'v228153', 'v228229', 'v228234', 'v228249', 'v228291', 'v228320', 'v228348', 'v228350', 'v228372', 'v228401', 'v228413', 'v228462', 'v228522', 'v228562', 'v228596', 'v228602', 'v228623', 'v228698', 'v228715', 'v228740', 'v228774', 'v228797', 'v228900', 'v228967', 'v228972', 'v228990', 'v229004', 'v229005', 'v229018', 'v229040', 'v229054', 'v229080', 'v229169', 'v229171', 'v229199', 'v229234', 'v229294', 'v229296', 'v229309', 'v229320', 'v229365', 'v229383', 'v229421', 'v229431', 'v229444', 'v229508', 'v229570', 'v229607', 'v229635', 'v229643', 'v229657', 'v229658', 'v229676', 'v229690', 'v229702', 'v229732', 'v229793', 'v229848', 'v229880', 'v229961', 'v229979', 'v229986', 'v230175', 'v230180', 'v230204', 'v230209', 'v230232', 'v230237', 'v230255', 'v230374', 'v230417', 'v230463', 'v230535', 'v230577', 'v230601', 'v230626', 'v230711', 'v230742', 'v230774', 'v230788', 'v230875', 'v230885', 'v231019', 'v231117', 'v231132', 'v231158', 'v231208', 'v231214', 'v231234', 'v231406', 'v231532', 'v231557', 'v231582', 'v231618', 'v231686', 'v231792', 'v231807', 'v231833', 'v231867', 'v231943', 'v232004', 'v232190', 'v232238', 'v232328', 'v232788', 'v232795', 'v232797', 'v232799', 'v232800', 'v232825', 'v232843', 'v232871', 'v232874', 'v232892', 'v232966', 'v233051', 'v233092', 'v233114', 'v233224', 'v233233', 'v233274', 'v233327', 'v233334', 'v233353', 'v233390', 'v233426', 'v233448', 'v233628', 'v233645', 'v233797', 'v233808', 'v233818', 'v233821', 'v233857', 'v233930', 'v234145', 'v234166', 'v234175', 'v234266', 'v234334', 'v234338', 'v234353', 'v234437', 'v234459', 'v234545', 'v234621', 'v234646', 'v234692', 'v234716', 'v234725', 'v234734', 'v234746', 'v234756', 'v234800', 'v234998', 'v235073', 'v235111', 'v235204', 'v235213', 'v235215', 'v235280', 'v235340', 'v235380', 'v235484', 'v235514', 'v235515', 'v235523', 'v235527', 'v235539', 'v235740', 'v235788', 'v235884', 'v236024', 'v236104', 'v236126', 'v236187', 'v236273', 'v236282', 'v236303', 'v236338', 'v236440', 'v236475', 'v236542', 'v236672', 'v236716', 'v236751', 'v236800', 'v236967', 'v236970', 'v236972', 'v236981', 'v237028', 'v237156', 'v237171', 'v237179', 'v237353', 'v237442', 'v237519', 'v237544', 'v237583', 'v237663', 'v237760', 'v237791', 'v237881', 'v238056', 'v238061', 'v238094', 'v238133', 'v238149', 'v238162', 'v238235', 'v238237', 'v238277', 'v238385', 'v238405', 'v238633', 'v238654', 'v238703', 'v238941', 'v238994', 'v239000', 'v239076', 'v239090', 'v239121', 'v239163', 'v239220', 'v239237', 'v239268', 'v239326', 'v239382', 'v239451', 'v239474', 'v239477', 'v239506', 'v239539', 'v239569', 'v239606', 'v239651', 'v239660', 'v239801', 'v239813', 'v239823', 'v239915', 'v239936', 'v240008', 'v240026', 'v240170', 'v240252', 'v240270', 'v240345', 'v240447', 'v240465', 'v240535', 'v240565', 'v240622', 'v240779', 'v240850', 'v240858', 'v240906', 'v240915', 'v240968', 'v241016', 'v241023', 'v241275', 'v241288', 'v241412', 'v241492', 'v241519', 'v241647', 'v241708', 'v241858', 'v241882', 'v241919', 'v242109', 'v242151', 'v242217', 'v242271', 'v242359', 'v242429', 'v242450', 'v242468', 'v242527', 'v242543', 'v242673', 'v242681', 'v242734', 'v242746', 'v242780', 'v242815', 'v242830', 'v242886', 'v242981', 'v242988', 'v242992', 'v243032', 'v243120', 'v243124', 'v243141', 'v243277', 'v243341', 'v243343', 'v243346', 'v243373', 'v243421', 'v243429', 'v243437', 'v243461', 'v243582', 'v243631', 'v243635', 'v243695', 'v243960', 'v244000', 'v244056', 'v244160', 'v244169', 'v244196', 'v244227', 'v244256', 'v244293', 'v244307', 'v244311', 'v244318', 'v244436', 'v244508', 'v244540', 'v244670', 'v244697', 'v244817', 'v244869', 'v244884', 'v244905', 'v244926', 'v244945', 'v244954', 'v244962', 'v245014', 'v245024', 'v245074', 'v245095', 'v245133', 'v245197', 'v245293', 'v245301', 'v248342', 'v248488', 'v248656', 'v249119', 'v249606', 'v249861', 'v251090', 'v251551', 'v253904', 'v255219', 'v256500', 'v257576', 'v258765', 'v268357', 'v268847', 'v269018', 'v269117', 'v269176', 'v269791', 'v269796', 'v270267', 'v270491', 'v271064', 'v271068', 'v271069', 'v271071', 'v272773', 'v274485', 'v274812', 'v274933', 'v276191', 'v276254', 'v276890', 'v277177', 'v277207', 'v277247', 'v277352', 'v277718', 'v277847', 'v278200', 'v278975', 'v278979', 'v278980', 'v280239', 'v280325', 'v280409', 'v280470', 'v285366', 'v285512', 'v289928', 'v289942', 'v289950', 'v295397', 'v296474', 'v298226', 'v299399', 'v306612', 'v306804', 'v310484', 'v310485', 'v310489', 'v310786', 'v500913', 'v501553', 'v501558', 'v501562', 'v501578', 'v501728', 'v501729', 'v502460', 'v502461', 'v502466', 'v502627', 'v502628', 'v504447', 'v505082', 'v510509', 'v510526', 'v511082', 'v512795', 'v512806', 'v512807', 'v512808', 'v512810', 'v512852', 'v513112', 'v513212', 'v513590', 'v513743', 'v513810', 'v513813', 'v513944', 'v513966', 'v514129', 'v514131', 'v514204', 'v514261', 'v514281', 'v514299', 'v514324', 'v514326', 'v514340', 'v514453', 'v514454', 'v514455', 'v514456', 'v514462', 'v514464', 'v514484', 'v514485', 'v514489', 'v514523', 'v514622', 'v514623', 'v514696', 'v514733', 'v514745', 'v514859', 'v514880', 'v514882', 'v514904', 'v514956', 'v515109', 'v515112', 'v515120', 'v515121', 'v515163', 'v515165', 'v515175', 'v515183', 'v515197', 'v515198', 'v515253', 'v515255', 'v515267', 'v515269', 'v515325', 'v515387', 'v515398', 'v515404', 'v515449', 'v515461', 'v515562', 'v515599', 'v515600', 'v515608', 'v515609', 'v515631', 'v515702', 'v515714', 'v515715', 'v515738', 'v515773', 'v515794', 'v515816', 'v515823', 'v515833', 'v515835', 'v515837', 'v515853', 'v515883', 'v515924', 'v515934', 'v515959', 'v515973', 'v515978', 'v515991', 'v516018', 'v516022', 'v516039', 'v516059', 'v516061', 'v516064', 'v516074', 'v516082', 'v516083', 'v516085', 'v516119', 'v516123', 'v516127', 'v516170', 'v516181', 'v516235', 'v516253', 'v516255', 'v516294', 'v516296', 'v516307', 'v516308', 'v516310', 'v516329', 'v516344', 'v516347', 'v516360', 'v516391', 'v516392', 'v516409', 'v516424', 'v516427', 'v516448', 'v516459', 'v516483', 'v516510', 'v516515', 'v516530', 'v516547', 'v516554', 'v516562', 'v516563', 'v516567', 'v516590', 'v516591', 'v516592', 'v516604', 'v516633', 'v516638', 'v516662', 'v516673', 'v516674', 'v516677', 'v516684', 'v516685', 'v516740', 'v516741', 'v516746', 'v516747', 'v516793', 'v516806', 'v516827', 'v516886', 'v516939', 'v516976', 'v516988', 'v517021', 'v517060', 'v517061', 'v517063', 'v517072', 'v517073', 'v517074', 'v517076', 'v517078', 'v517111', 'v517113', 'v517179', 'v517207', 'v517212', 'v517249', 'v517250', 'v517268', 'v517275', 'v517285', 'v517320', 'v517339', 'v517342', 'v517359', 'v517414', 'v517418', 'v517421', 'v517422', 'v517429', 'v517433', 'v517434', 'v517436', 'v517442', 'v517445', 'v517457', 'v517458', 'v517463', 'v517469', 'v517491', 'v517522', 'v517523', 'v517544', 'v517556', 'v517557', 'v517561', 'v517567', 'v517568', 'v517569', 'v517570', 'v517571', 'v517574', 'v517577', 'v517581', 'v517669', 'v517699', 'v517709', 'v517785', 'v517811', 'v517820', 'v517822', 'v517843', 'v517851', 'v517897', 'v517905', 'v517907', 'v517921', 'v517924', 'v517927', 'v517928', 'v517936', 'v518052', 'v518053', 'v518058', 'v518073', 'v518151', 'v518165', 'v518244', 'v518246', 'v518248', 'v518249', 'v518301', 'v518320', 'v518324', 'v518327', 'v518328', 'v518336', 'v518354', 'v518357', 'v518359', 'v518367', 'v518397', 'v518423', 'v518461', 'v518463', 'v518496', 'v518508', 'v518516', 'v518541', 'v518555', 'v518556', 'v518559', 'v518572', 'v518574', 'v518575', 'v518581', 'v518585', 'v518604', 'v518617', 'v536114', 'v551367', 'v552657', 'v553403', 'v553411', 'v553774', 'v555639', 'v562701', 'v566685', 'v566689', 'v568644', 'v568665', 'v569326', 'v574012', 'v599746', 'v603841', 'v606724', 'v614694', 'v617094', 'v621033', 'v621037', 'v621207', 'v626064', 'v634793', 'v634845', 'v635979', 'v636001', 'v636812', 'v636819', 'v637625', 'v639417', 'v642409', 'v642415', 'v642897', 'v643201', 'v643490', 'v643895', 'v644113', 'v644119', 'v644263', 'v644271', 'v644277', 'v644332', 'v644349', 'v644908', 'v644923', 'v645813', 'v646271', 'v646342', 'v646888', 'v647206', 'v647319', 'v647406', 'v647572', 'v647575', 'v647576', 'v647797', 'v647899', 'v647975', 'v648067', 'v648590', 'v648698', 'v648703', 'v648741', 'v648759', 'v648763', 'v649003', 'v649004', 'v649757', 'v650008', 'v650113', 'v650145', 'v650860', 'v650861', 'v651275', 'v651800', 'v652004', 'v652089', 'v652114', 'v652584', 'v652599', 'v652802', 'v652985', 'v653009', 'v653750', 'v653770', 'v654909', 'v655189', 'v655391', 'v655434', 'v655435', 'v656095', 'v656096', 'v656113', 'v656114', 'v657551', 'v657659', 'v657660', 'v658405', 'v658406', 'v658407', 'v658620', 'v658682', 'v658683', 'v658684', 'v659196', 'v659768', 'v660087', 'v660088', 'v660089', 'v660090', 'v660091', 'v660333', 'v660894', 'v661384', 'v661385', 'v661398', 'v661460', 'v661585', 'v661685', 'v661689', 'v661690', 'v661755', 'v661852', 'v662646', 'v662705', 'v662940', 'v662991', 'v662992', 'v662998', 'v662999', 'v663001', 'v663004', 'v663224', 'v663255', 'v663297', 'v664228', 'v664580', 'v664582', 'v664583', 'v664585', 'v664674', 'v664676', 'v664677', 'v664678', 'v664679', 'v665055', 'v665056', 'v665189', 'v665800', 'v665867', 'v666087', 'v666088', 'v666096', 'v666112', 'v667244', 'v667576', 'v667772', 'v668040', 'v670046', 'v671105', 'v671157', 'v671478', 'v671479', 'v672005', 'v672299', 'v672696', 'v672697', 'v674252', 'v674483', 'v674484', 'v675211', 'v675563', 'v675564', 'v675565', 'v675631', 'v675632', 'v675752', 'v675771', 'v675772', 'v675773', 'v676056', 'v676188', 'v676239', 'v676242', 'v676399', 'v676400', 'v676401', 'v676496', 'v676617', 'v676704', 'v676705', 'v676706', 'v676707', 'v676827', 'v676828', 'v676831', 'v676832', 'v677005', 'v677103', 'v677742', 'v677767', 'v677971', 'v678132', 'v678380', 'v678381', 'v679033', 'v679292', 'v679293', 'v679360', 'v679417', 'v680621', 'v680642', 'v680643', 'v680644', 'v680649', 'v680654', 'v680676', 'v680967', 'v680976', 'v681131', 'v682535', 'v682632', 'v683303', 'v683304', 'v683358', 'v683359', 'v683412', 'v683413', 'v683481', 'v683527', 'v683528', 'v683563', 'v683565', 'v683568', 'v683668', 'v683670', 'v683681', 'v683682', 'v683683', 'v683699', 'v683702', 'v683703', 'v683704', 'v683708', 'v683740', 'v683741', 'v683742', 'v683747', 'v683749', 'v683777', 'v683778', 'v683779', 'v683793', 'v683794', 'v683795', 'v683796', 'v683797', 'v683798', 'v683799', 'v683800', 'v683801', 'v683802', 'v683803', 'v683826', 'v683827', 'v683835', 'v683836', 'v683837', 'v683848', 'v683849', 'v683850', 'v684113', 'v684154', 'v684155', 'v684178', 'v684179', 'v684213', 'v684219', 'v684230', 'v684244', 'v684249', 'v684254', 'v684364', 'v684455', 'v684456', 'v685769', 'v685989', 'v686380', 'v686418', 'v686523', 'v686568', 'v686569', 'v686578', 'v686579', 'v686580', 'v686675', 'v686730', 'v686791', 'v686834', 'v686835', 'v686836', 'v686837', 'v686896', 'v687092', 'v687094', 'v687097', 'v687490', 'v687705', 'v687779', 'v687780', 'v687782', 'v687931', 'v688052', 'v688221', 'v688395', 'v688402', 'v688440', 'v688513', 'v689530', 'v689542', 'v689543', 'v689555', 'v689569', 'v689571', 'v689580', 'v689583', 'v689588', 'v689600', 'v689643', 'v689667', 'v690233', 'v690388', 'v690718', 'v690723', 'v691644', 'v691747', 'v691754', 'v691758', 'v691760', 'v692329', 'v692374', 'v692837', 'v692952', 'v692953', 'v694316', 'v694320', 'v694370', 'v694385', 'v694405', 'v694857', 'v695557', 'v695558', 'v695560', 'v695563', 'v695602', 'v697797', 'v697894', 'v698050', 'v698199', 'v698401', 'v698800', 'v698803', 'v699114', 'v699221', 'v699448', 'v699526', 'v699683', 'v699721', 'v699773', 'v699926', 'v699930', 'v699931', 'v699977', 'v699990', 'v700092', 'v700153', 'v700576', 'v700594', 'v700982', 'v701088', 'v701168', 'v701203', 'v701249', 'v701256', 'v701286', 'v701363', 'v701396', 'v701930', 'v702288', 'v702293', 'v702294', 'v702489', 'v702505', 'v702507', 'v702575', 'v702677', 'v703195', 'v703273', 'v703571', 'v703739', 'v704039', 'v704069', 'v704083', 'v704108', 'v704144', 'v704149', 'v704151', 'v704152', 'v704154', 'v704161', 'v704163', 'v704169', 'v704225', 'v704257', 'v704282', 'v704355', 'v704376', 'v704452', 'v704454', 'v704557', 'v704627', 'v704693', 'v704695', 'v704862', 'v704863', 'v704864', 'v704866', 'v704894', 'v704895', 'v705008', 'v705033', 'v705292', 'v705340', 'v705346', 'v705617', 'v705661', 'v705861', 'v705884', 'v706096', 'v706284', 'v706402', 'v706403', 'v706404', 'v706410', 'v706413', 'v706414', 'v706416', 'v706423', 'v706424', 'v706429', 'v706432', 'v706433', 'v706465', 'v706467', 'v706566', 'v706574', 'v706613', 'v706616', 'v706643', 'v706680', 'v706681', 'v706682', 'v706683', 'v706685', 'v706720', 'v706810', 'v706876', 'v706881', 'v706935', 'v706937', 'v706939', 'v706944', 'v707100', 'v707140', 'v707141', 'v707142', 'v707143', 'v707238', 'v707240', 'v707242', 'v707388', 'v707400', 'v707417', 'v707451', 'v707454', 'v707463', 'v707565', 'v707624', 'v707625', 'v707832', 'v707887', 'v707895', 'v707911', 'v707927', 'v707928', 'v707943', 'v707945', 'v707986', 'v708724', 'v709584', 'v709808', 'v710076', 'v711371', 'v711592', 'v711654', 'v711739', 'v711762', 'v711888', 'v711926', 'v711960', 'v711976', 'v711991', 'v712012', 'v712015', 'v712030', 'v712031', 'v712033', 'v712045', 'v712192', 'v712271', 'v712275', 'v712318', 'v712710', 'v712719', 'v712837', 'v713496', 'v713699', 'v715141', 'v716330', 'v718523', 'v718833', 'v719051', 'v719054', 'v719055', 'v720385', 'v721703', 'v721704', 'v723144', 'v723295', 'v723629', 'v724111', 'v724129', 'v724220', 'v724332', 'v725063', 'v725141', 'v725145', 'v725184', 'v726403', 'v727439', 'v731406', 'v731407', 'v731408', 'v731409', 'v731410', 'v731471', 'v731472', 'v731473', 'v731734', 'v731784', 'v731785', 'v731875', 'v731976', 'v732528', 'v732584', 'v732961', 'v732974', 'v733110', 'v733118', 'v733562', 'v733611', 'v733648', 'v733651', 'v733652', 'v733654', 'v733655', 'v733656', 'v733658', 'v733659', 'v733660', 'v733822', 'v733964', 'v733985', 'v734016', 'v734228', 'v734667', 'v735668', 'v735702', 'v735705', 'v735973', 'v735974', 'v737540', 'v738090', 'v738091', 'v738738', 'v738739', 'v738742', 'v739548', 'v739633', 'v739634', 'v739652', 'v739854', 'v739991', 'v740000', 'v740095', 'v740108', 'v740325', 'v740481', 'v740482', 'v740638', 'v741518', 'v741553', 'v742435', 'v744450', 'v745312', 'v746970', 'v746971', 'v746972', 'v746973', 'v747795', 'v747808', 'v747946', 'v747979', 'v747989', 'v747993', 'v748224', 'v748477', 'v748559', 'v748594', 'v749438', 'v749463', 'v749590', 'v749946', 'v749947', 'v750854', 'v750856', 'v750857', 'v750858', 'v751498', 'v752209', 'v752455', 'v752517', 'v752822', 'v752823', 'v752933', 'v752971', 'v753167', 'v753168', 'v753169', 'v753176', 'v753326', 'v753343', 'v753691', 'v753736', 'v754681', 'v755302', 'v755381', 'v756870', 'v757037', 'v757038', 'v758050', 'v758086', 'v758122');'''
    data = []
    _count = 0
    for uid, b_c, p_c, c_c, q_url in MysqlSource(poi_ori_config, table_or_query=sql,
                                                 size=10000, is_table=False,
                                                 is_dict_cursor=False):
        _count += 1
        if not str(q_url).endswith('/'):
            q_url += '/'
        q_url_id = re.findall('http://place.qyer.com/poi/(\S+?)/', q_url)[-1]

        bc_d = json.loads(b_c)
        # if 'qyer' in bc_d:
        #     del bc_d['qyer']
        pc_d = json.loads(p_c)
        # if 'qyer' in pc_d:
        #     del pc_d['qyer']
        # cc_d = json.loads(c_c)
        # del cc_d['qyer']

        res = g_dict.get(q_url_id)
        if res:
            bc, cc, pc = res
            bc_d['qyer'] = int(bc)
            # cc_d['qyer'] = int(cc)
            pc_d['qyer'] = int(pc)
            print(uid, json.dumps(bc_d), json.dumps(pc_d), q_url_id, q_url)
        else:
            print('##' * 10)
            print(uid, json.dumps(bc_d), json.dumps(pc_d), q_url_id, q_url)
            print('##' * 10)

        logger.info("[count: {}]".format(_count))
        # update_sql((json.dumps(bc_d), json.dumps(pc_d), uid))
        # if len(data) == 1000:
        #     logger.info("[count: {}]".format(_count))
        #         update_sql(data)
        #         data = []
        # update_sql(data)


if __name__ == '__main__':
    get_task()
